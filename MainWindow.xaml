<Window x:Class="EnvVarManager.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:EnvVarManager"
        mc:Ignorable="d"
        Title="Windows 环境变量管理器"
        Height="620"
        Width="960"
        WindowStartupLocation="CenterScreen"
        Style="{StaticResource AppWindowStyle}">
    <Grid Margin="16">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <!-- 顶部标题和筛选区域 -->
        <Border Background="White"
                BorderBrush="{StaticResource NeutralBorderBrush}"
                BorderThickness="1"
                CornerRadius="8"
                Padding="16"
                Margin="0,0,0,12">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>

                <StackPanel Orientation="Vertical">
                    <TextBlock Text="环境变量管理"
                               FontSize="18"
                               FontWeight="Bold"
                               Margin="0,0,0,4" />
                    <TextBlock Text="快速查看、编辑、备份和恢复 Windows 用户 / 系统环境变量"
                               Foreground="{StaticResource SubtleForegroundBrush}" />
                </StackPanel>

                <StackPanel Orientation="Horizontal"
                            Grid.Column="1"
                            VerticalAlignment="Center"
                            HorizontalAlignment="Right"
                            Spacing="8">
                    <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                        <TextBlock Text="作用域：" VerticalAlignment="Center" Margin="0,0,6,0" />
                        <ComboBox x:Name="ScopeComboBox"
                                  Width="160"
                                  SelectionChanged="ScopeComboBox_SelectionChanged">
                            <ComboBoxItem Content="当前用户变量" Tag="User" IsSelected="True" />
                            <ComboBoxItem Content="本机系统变量" Tag="System" />
                        </ComboBox>
                    </StackPanel>

                    <Button Content="刷新"
                            Style="{StaticResource SecondaryButtonStyle}"
                            Click="RefreshButton_Click" />
                </StackPanel>
            </Grid>
        </Border>

        <!-- 中间主区域 -->
        <Grid Grid.Row="1">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>

            <!-- 操作按钮条 -->
            <DockPanel Margin="0,0,0,8">
                <StackPanel Orientation="Horizontal"
                            DockPanel.Dock="Left"
                            Spacing="8">
                    <Button Content="新增变量"
                            Style="{StaticResource PrimaryButtonStyle}"
                            Click="AddButton_Click" />
                    <Button Content="编辑选中"
                            Style="{StaticResource SecondaryButtonStyle}"
                            Click="EditButton_Click" />
                    <Button Content="删除选中"
                            Style="{StaticResource DangerButtonStyle}"
                            Click="DeleteButton_Click" />
                </StackPanel>

                <StackPanel Orientation="Horizontal"
                            DockPanel.Dock="Right"
                            Spacing="8">
                    <Button Content="备份到 JSON"
                            Style="{StaticResource SecondaryButtonStyle}"
                            Click="BackupButton_Click" />
                    <Button Content="从 JSON 恢复"
                            Style="{StaticResource SecondaryButtonStyle}"
                            Click="RestoreButton_Click" />
                </StackPanel>
            </DockPanel>

            <!-- 列表卡片 -->
            <Border Grid.Row="1"
                    Background="White"
                    BorderBrush="{StaticResource NeutralBorderBrush}"
                    BorderThickness="1"
                    CornerRadius="8">
                <DataGrid x:Name="EnvDataGrid"
                          Margin="8"
                          IsReadOnly="True"
                          SelectionMode="Single"
                          CanUserAddRows="False">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="名称"
                                            Binding="{Binding Name}"
                                            Width="220" />
                        <DataGridTextColumn Header="值"
                                            Binding="{Binding Value}"
                                            Width="*" />
                    </DataGrid.Columns>
                </DataGrid>
            </Border>
        </Grid>

        <!-- 底部提示区域 -->
        <Border Grid.Row="2"
                Margin="0,12,0,0"
                Background="{StaticResource PrimaryLightBrush}"
                CornerRadius="6"
                Padding="10">
            <StackPanel Orientation="Vertical">
                <TextBlock Text="安全提示"
                           FontWeight="SemiBold"
                           Foreground="{StaticResource PrimaryDarkBrush}" />
                <TextBlock Margin="0,2,0,0"
                           TextWrapping="Wrap"
                           Foreground="{StaticResource SubtleForegroundBrush}"
                           FontSize="11">
                    修改系统变量可能需要管理员权限；更改仅对更改之后启动的进程生效，已打开的程序需要重新启动。
                </TextBlock>
            </StackPanel>
        </Border>
    </Grid>
</Window>
